<div class="rounded-2xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03]">
  <div class="flex flex-col gap-4 p-4">
    <div class="flex flex-wrap items-center justify-between gap-3">
      @if (isAdmin) {
        <div class="flex flex-wrap items-center gap-3">
          <label class="text-sm font-medium text-gray-700 dark:text-gray-200" for="employee-filter">Empleado:</label>
          <select
            id="employee-filter"
            class="h-10 min-w-[200px] rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm text-gray-800 shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90"
            (change)="handleEmployeeFilterChange($any($event.target).value || 'all')"
            [ngModel]="selectedEmployeeFilter"
          >
            <option value="all">Todos los empleados</option>
            @for (employee of employees; track employee.id) {
              <option [value]="employee.id">{{ employee.name }}</option>
            }
          </select>
        </div>
      } @else {
        <div class="flex flex-wrap items-center gap-3">
          <span class="text-sm font-medium text-gray-700 dark:text-gray-200">Empleado: {{ currentUser?.name }}</span>
        </div>
      }
      <div class="flex flex-wrap items-center gap-2">
        <button
          type="button"
          (click)="openVacationModal()"
          class="flex items-center gap-2 h-10 rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-theme-xs transition hover:bg-gray-50 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:hover:bg-gray-800"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="16" y1="2" x2="16" y2="6"></line>
            <line x1="8" y1="2" x2="8" y2="6"></line>
            <line x1="3" y1="10" x2="21" y2="10"></line>
          </svg>
          Solicitar Vacaciones
        </button>
        @if (isAdmin) {
          <button
            type="button"
            (click)="openVacationManagement()"
            class="flex items-center gap-2 h-10 rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-theme-xs transition hover:bg-gray-50 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:hover:bg-gray-800"
          >
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
              <circle cx="8.5" cy="7" r="4"></circle>
              <polyline points="17 11 19 13 23 9"></polyline>
            </svg>
            Gestionar Solicitudes
            @if (getPendingRequestsCount() > 0) {
              <span class="flex items-center justify-center w-5 h-5 text-xs font-bold text-white bg-red-500 rounded-full">
                {{ getPendingRequestsCount() }}
              </span>
            }
          </button>
        }
        <button
          type="button"
          (click)="exportToGoogleCalendar()"
          class="flex items-center gap-2 h-10 rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-theme-xs transition hover:bg-gray-50 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:hover:bg-gray-800"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="16" y1="2" x2="16" y2="6"></line>
            <line x1="8" y1="2" x2="8" y2="6"></line>
            <line x1="3" y1="10" x2="21" y2="10"></line>
          </svg>
          Exportar Calendar
        </button>
      </div>
    </div>

    <div class="custom-calendar relative min-h-[400px]">
      @if (isCalendarLoading) {
        <div class="absolute inset-0 z-10 flex items-center justify-center bg-white/80 backdrop-blur-sm dark:bg-gray-900/80">
          <div class="flex items-center gap-3 text-sm font-medium text-gray-700 dark:text-gray-200">
            <span class="h-3 w-3 animate-pulse rounded-full bg-brand-500"></span>
            {{ loadingMessage }}
          </div>
        </div>
      }

      @if (!isCalendarLoading) {
        <full-calendar #calendar [options]="calendarOptions"></full-calendar>
      }
    </div>
  </div>

  <app-modal
    [isOpen]="isOpen && isAdmin"
    (close)="closeModal()"
    className="max-w-[700px] p-6 lg:p-10"
  >
    <div class="flex flex-col px-2 overflow-y-auto custom-scrollbar">
      @if (alerts.length) {
        <div class="flex flex-col gap-3 mb-6">
          @for (alert of alerts; track alert.id) {
            <div class="relative">
              <app-alert
                [variant]="alert.variant"
                [title]="alert.title"
                [message]="alert.message"
              ></app-alert>
              <button
                type="button"
                class="absolute right-3 top-3 text-gray-400 transition hover:text-gray-600 dark:hover:text-gray-200"
                aria-label="Cerrar alerta"
                (click)="dismissAlert(alert.id)"
              >
                ‚úï
              </button>
            </div>
          }
        </div>
      }
      <div>
        <h5 class="mb-2 font-semibold text-gray-800 modal-title text-theme-xl dark:text-white/90 lg:text-2xl">
          {{ selectedEvent ? 'Editar tarea' : 'Agregar tarea' }}
        </h5>
        <p class="text-sm text-gray-500 dark:text-gray-400">
          Importante colocar localizaci√≥n y empleado.
        </p>
      </div>
      <!-- Event Title - Hidden (generated automatically) -->
      <div class="mt-8 hidden">
        <div>
          <label class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">
            Titulo del evento
          </label>
          <input
            id="event-title"
            type="text"
            [(ngModel)]="eventTitle"
            class="dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800"
          />
        </div>
      </div>


      <!-- Fecha de la Tarea - Hidden (se obtiene del click en el calendario) -->
      <div class="mt-6 hidden">
        <label class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">
          Fecha de la Tarea
        </label>
        <input
          id="event-start-date"
          type="date"
          [(ngModel)]="eventStartDate"
          (ngModelChange)="onDateChange()"
          class="h-11 w-full rounded-lg border border-gray-300 bg-white dark:bg-gray-900 px-4 py-2.5 text-sm text-gray-800 dark:text-white shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700"
        />
      </div>

      <div class="mt-6">
        <label class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">
          Localizaci√≥n
        </label>
        <select
          [(ngModel)]="eventLocation"
          class="h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90"
        >
          <option value="">Seleccionar localizaci√≥n</option>
          @for (location of locations; track location.id) {
            <option [value]="location.name">{{ location.name }} ({{ location.city }})</option>
          }
        </select>
      </div>

      <div class="mt-6">
        <label class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">
          Empleado Asignado
        </label>
        <select
          [(ngModel)]="eventEmployeeId"
          class="h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90"
        >
          <option [ngValue]="undefined">Seleccionar empleado</option>
          @for (employee of employees; track employee.id) {
            <option
              [ngValue]="employee.id"
              [disabled]="!isEmployeeAvailable(employee.id)"
              [class.text-gray-400]="!isEmployeeAvailable(employee.id)"
            >
              {{ employee.name }} ({{ employee.role }})
              @if (!isEmployeeAvailable(employee.id)) {
                - {{ getEmployeeVacationInfo(employee.id) }}
              }
            </option>
          }
        </select>
        @if (eventEmployeeId && !isEmployeeAvailable(eventEmployeeId)) {
          <p class="mt-2 text-sm text-orange-600 dark:text-orange-400">
            ‚ö†Ô∏è Este empleado no est√° disponible en la fecha seleccionada
          </p>
        }
      </div>

      <div class="grid grid-cols-2 gap-4 mt-6">
        <div>
          <label class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">
            Hora de Inicio
          </label>
          <input
            type="time"
            [(ngModel)]="eventStartTime"
            class="h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90"
          />
        </div>

        <div>
          <label class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">
            Hora de Fin
          </label>
          <input
            type="time"
            [(ngModel)]="eventEndTime"
            class="h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90"
          />
        </div>
      </div>

      <div class="flex items-center gap-3 mt-6 modal-footer sm:justify-end">
        <button
          (click)="closeModal()"
          type="button"
          class="flex w-full justify-center rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400 sm:w-auto"
        >
          Cerrar
        </button>
        <button
          (click)="handleAddOrUpdateEvent()"
          type="button"
          class="btn btn-success btn-update-event flex w-full justify-center rounded-lg bg-brand-500 px-4 py-2.5 text-sm font-medium text-white hover:bg-brand-600 sm:w-auto"
          [disabled]="isAddEventLoading"
        >
          <span *ngIf="isAddEventLoading" class="animate-spin mr-2">‚è≥</span>
          {{ selectedEvent ? 'Actualizar cambios' : 'A√±adir evento' }}
        </button>
      </div>
    </div>
  </app-modal>

  <!-- Modal de eventos por d√≠a cuando hay m√°s de 3 -->
  <app-modal
    [isOpen]="isDayModalOpen"
    (close)="isDayModalOpen = false"
    className="max-w-[600px] p-6 lg:p-8"
  >
    <div class="flex flex-col gap-4">
      <div>
        <h5 class="mb-1 font-semibold text-gray-800 text-lg dark:text-white/90">
          Eventos del {{ selectedDay || '' }}
        </h5>
        <p class="text-sm text-gray-500 dark:text-gray-400">
          Lista de tareas para este d√≠a.
        </p>
      </div>

      @if (!selectedDayEvents.length) {
        <div class="text-sm text-gray-500 dark:text-gray-400">
          No hay tareas en este d√≠a.
        </div>
      } @else {
        <div class="flex flex-col gap-3 max-h-[60vh] overflow-y-auto custom-scrollbar">
          @for (ev of selectedDayEvents; track ev.id) {
            <div class="flex items-center justify-between gap-3 rounded-lg border border-gray-200 bg-gray-50 px-3 py-2 dark:border-gray-800 dark:bg-white/[0.04]">
              <div class="flex items-center gap-3">
                @if (ev.employeeAvatar) {
                  <img
                    [src]="ev.employeeAvatar"
                    [alt]="ev.employeeName || 'Empleado'"
                    class="h-9 w-9 rounded-full object-cover border-2"
                    [style.border-color]="ev.employeeColor || '#6366f1'"
                  />
                } @else {
                  <div
                    class="h-9 w-9 rounded-full flex items-center justify-center text-xs font-semibold text-white"
                    [style.background-color]="ev.employeeColor || '#6366f1'"
                  >
                    {{ ev.employeeName ? ev.employeeName[0] : 'T' }}
                  </div>
                }
                <div class="flex flex-col text-sm">
                  <span class="font-semibold text-gray-800 dark:text-white/90">{{ ev.employeeName || 'Tarea' }}</span>
                  @if (ev.isVacation) {
                    <span class="text-gray-600 dark:text-gray-300">{{ ev.vacationType === 'vacation' ? 'üèñÔ∏è Vacaciones' : 'üìÖ D√≠a Libre' }}</span>
                  } @else {
                    <span class="text-gray-600 dark:text-gray-300">{{ ev.location || 'Sin localizaci√≥n' }}</span>
                    <span class="text-gray-500 dark:text-gray-400">{{ ev.startTime && ev.endTime ? formatTimeWithoutSeconds(ev.startTime) + ' - ' + formatTimeWithoutSeconds(ev.endTime) : '' }}</span>
                  }
                </div>
              </div>
              <div class="flex items-center gap-2">
                @if (isAdmin && !ev.isVacation) {
                  <button
                    type="button"
                    class="rounded-md border border-gray-300 px-3 py-1 text-xs font-medium text-gray-700 hover:bg-gray-100 dark:border-gray-700 dark:text-gray-200"
                    (click)="handleDayEventEdit(ev.id)"
                  >
                    Editar
                  </button>
                  <button
                    type="button"
                    class="rounded-md border border-red-200 px-3 py-1 text-xs font-medium text-red-600 hover:bg-red-50 dark:border-red-800"
                    (click)="handleDayEventDelete(ev.id)"
                  >
                    Eliminar
                  </button>
                } @else if (!isAdmin && !ev.isVacation) {
                  <span class="text-xs text-gray-500 dark:text-gray-400 italic">
                    No tienes permisos para editar
                  </span>
                } @else if (ev.isVacation) {
                  <span class="text-xs text-gray-500 dark:text-gray-400 italic">
                    Solo se puede gestionar desde solicitudes
                  </span>
                }
              </div>
            </div>
          }
        </div>
      }

      <div class="flex items-center gap-3 justify-end pt-2">
        <button
          type="button"
          class="flex w-full justify-center rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 sm:w-auto"
          (click)="isDayModalOpen = false"
        >
          Cerrar
        </button>
        @if (isAdmin) {
          <button
            type="button"
            class="flex w-full justify-center rounded-lg bg-brand-500 px-4 py-2.5 text-sm font-medium text-white hover:bg-brand-600 sm:w-auto"
            (click)="handleDayEventCreate()"
          >
            Nueva tarea en este d√≠a
          </button>
        }
      </div>
    </div>
  </app-modal>

  <!-- Modal de Confirmaci√≥n de Conflictos -->
  @if (showConflictModal) {
    <div class="fixed inset-0 z-[999999] flex items-center justify-center bg-black/50 dark:bg-black/70" (click)="rejectEventCreation()">
      <div class="rounded-2xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 p-6 max-w-md w-full mx-4 shadow-2xl" (click)="$event.stopPropagation()">
        <div class="flex items-start gap-4">
          <div class="flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100 dark:bg-yellow-900/30">
            <svg class="h-6 w-6 text-yellow-600 dark:text-yellow-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c.866-1.5 2.926-5.231 2.926-5.231s.584-4.506 3.986-5.021c3.21-.476 4.44.688 5.953 5.237.559 1.501.625 2.738.946 4.284"/>
            </svg>
          </div>
          <div class="flex-1">
            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">‚ö†Ô∏è Conflicto de horarios</h3>
            <p class="text-sm text-gray-600 dark:text-gray-400 mb-4">
              Ya existe una tarea asignada al empleado en este rango horario. ¬øDeseas crear esta tarea de todas formas?
            </p>
            @if (conflictEvent) {
              <div class="bg-gray-50 dark:bg-gray-900/50 rounded-lg p-3 mb-4 border border-gray-200 dark:border-gray-700">
                <p class="text-sm font-medium text-gray-700 dark:text-gray-300">Tarea existente:</p>
                <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">
                  <strong>{{ conflictEvent.extendedProps.employeeName }}</strong>
                </p>
                <p class="text-sm text-gray-600 dark:text-gray-400">
                  üìç {{ conflictEvent.extendedProps.location }}
                </p>
                <p class="text-sm text-gray-600 dark:text-gray-400">
                  üïê {{ formatTimeWithoutSeconds(conflictEvent.extendedProps.startTime) }} - {{ formatTimeWithoutSeconds(conflictEvent.extendedProps.endTime) }}
                </p>
              </div>
            }
          </div>
        </div>

        <div class="flex gap-3 mt-6">
          <button
            type="button"
            (click)="rejectEventCreation()"
            class="flex-1 px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 font-medium text-sm transition"
          >
            Cancelar
          </button>
          <button
            type="button"
            (click)="proceedWithEventCreation()"
            class="flex-1 px-4 py-2 rounded-lg bg-yellow-600 hover:bg-yellow-700 text-white font-medium text-sm transition"
          >
            Crear igualmente
          </button>
        </div>
      </div>
    </div>
  }

  <!-- Modal para Solicitar Vacaciones -->
  <app-modal
    [isOpen]="isVacationModalOpen"
    (close)="closeVacationModal()"
    className="max-w-[600px] p-6 lg:p-8"
  >
    <div class="flex flex-col px-2">
      @if (alerts.length) {
        <div class="flex flex-col gap-3 mb-6">
          @for (alert of alerts; track alert.id) {
            <div class="relative">
              <app-alert
                [variant]="alert.variant"
                [title]="alert.title"
                [message]="alert.message"
              ></app-alert>
              <button
                type="button"
                class="absolute right-3 top-3 text-gray-400 transition hover:text-gray-600 dark:hover:text-gray-200"
                aria-label="Cerrar alerta"
                (click)="dismissAlert(alert.id)"
              >
                ‚úï
              </button>
            </div>
          }
        </div>
      }
      <h5 class="mb-4 font-semibold text-gray-800 text-theme-xl dark:text-white/90 lg:text-2xl">
        Solicitar Vacaciones o D√≠a Libre
      </h5>

      <div class="mt-4">
        <label class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">
          Tipo de Solicitud
        </label>
        <select
          [(ngModel)]="vacationType"
          class="h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90"
        >
          <option value="vacation">üèñÔ∏è Vacaciones</option>
          <option value="day-off">üìÖ D√≠a Libre</option>
        </select>
      </div>

      <div class="mt-4">
        <label class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">
          Fecha de Inicio
        </label>
        <div class="relative">
          <button
            type="button"
            (click)="openStartDatePicker()"
            class="h-11 w-full rounded-lg border border-gray-300 bg-white dark:bg-gray-900 px-4 py-2.5 text-sm text-gray-800 dark:text-white shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 cursor-pointer text-left flex items-center justify-between"
          >
            <span>{{ formatDisplayDate(vacationStartDate) }}</span>
            <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
            </svg>
          </button>

          @if (showStartDatePicker) {
            <div class="absolute z-50 mt-2 p-4 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 w-full">
              <div class="flex items-center justify-between mb-4">
                <button type="button" (click)="previousMonth()" class="p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                  </svg>
                </button>
                <span class="font-semibold text-gray-800 dark:text-white">
                  {{ monthNames[calendarMonth] }} {{ calendarYear }}
                </span>
                <button type="button" (click)="nextMonth()" class="p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                  </svg>
                </button>
              </div>

              <div class="grid grid-cols-7 gap-1 text-center text-xs font-semibold text-gray-600 dark:text-gray-400 mb-2">
                <div>L</div><div>M</div><div>X</div><div>J</div><div>V</div><div>S</div><div>D</div>
              </div>

              <div class="grid grid-cols-7 gap-1">
                @for (day of calendarDays; track $index) {
                  <button
                    type="button"
                    (click)="selectDate(day, true)"
                    [disabled]="day === null"
                    [class]="day === null ? 'invisible' : 'h-8 rounded hover:bg-blue-100 dark:hover:bg-blue-900 text-sm'"
                    [ngClass]="{
                      'bg-blue-500 text-white hover:bg-blue-600': isSelectedDate(day, vacationStartDate),
                      'bg-blue-100 dark:bg-blue-900 font-semibold': isToday(day) && !isSelectedDate(day, vacationStartDate),
                      'text-gray-800 dark:text-white': !isSelectedDate(day, vacationStartDate)
                    }"
                  >
                    {{ day }}
                  </button>
                }
              </div>

              <button
                type="button"
                (click)="closeCalendarPickers()"
                class="mt-3 w-full px-3 py-2 text-sm bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded"
              >
                Cerrar
              </button>
            </div>
          }
        </div>
      </div>

      <div class="mt-4">
        <label class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">
          Fecha de Fin
        </label>
        <div class="relative">
          <button
            type="button"
            (click)="openEndDatePicker()"
            class="h-11 w-full rounded-lg border border-gray-300 bg-white dark:bg-gray-900 px-4 py-2.5 text-sm text-gray-800 dark:text-white shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 cursor-pointer text-left flex items-center justify-between"
          >
            <span>{{ formatDisplayDate(vacationEndDate) }}</span>
            <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
            </svg>
          </button>

          @if (showEndDatePicker) {
            <div class="absolute z-50 mt-2 p-4 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 w-full">
              <div class="flex items-center justify-between mb-4">
                <button type="button" (click)="previousMonth()" class="p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                  </svg>
                </button>
                <span class="font-semibold text-gray-800 dark:text-white">
                  {{ monthNames[calendarMonth] }} {{ calendarYear }}
                </span>
                <button type="button" (click)="nextMonth()" class="p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                  </svg>
                </button>
              </div>

              <div class="grid grid-cols-7 gap-1 text-center text-xs font-semibold text-gray-600 dark:text-gray-400 mb-2">
                <div>L</div><div>M</div><div>X</div><div>J</div><div>V</div><div>S</div><div>D</div>
              </div>

              <div class="grid grid-cols-7 gap-1">
                @for (day of calendarDays; track $index) {
                  <button
                    type="button"
                    (click)="selectDate(day, false)"
                    [disabled]="day === null"
                    [class]="day === null ? 'invisible' : 'h-8 rounded hover:bg-blue-100 dark:hover:bg-blue-900 text-sm'"
                    [ngClass]="{
                      'bg-blue-500 text-white hover:bg-blue-600': isSelectedDate(day, vacationEndDate),
                      'bg-blue-100 dark:bg-blue-900 font-semibold': isToday(day) && !isSelectedDate(day, vacationEndDate),
                      'text-gray-800 dark:text-white': !isSelectedDate(day, vacationEndDate)
                    }"
                  >
                    {{ day }}
                  </button>
                }
              </div>

              <button
                type="button"
                (click)="closeCalendarPickers()"
                class="mt-3 w-full px-3 py-2 text-sm bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded"
              >
                Cerrar
              </button>
            </div>
          }
        </div>
      </div>

      <div class="mt-4">
        <label class="mb-1.5 block text-sm font-medium text-gray-700 dark:text-gray-400">
          Motivo
        </label>
        <textarea
          [(ngModel)]="vacationReason"
          rows="3"
          placeholder="Describe el motivo de tu solicitud..."
          class="w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-700 dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30"
        ></textarea>
      </div>

      <div class="flex items-center gap-3 justify-end pt-6 mt-6 border-t border-gray-200 dark:border-gray-700">
        <button
          type="button"
          class="rounded-lg border border-gray-300 bg-white px-6 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300"
          (click)="closeVacationModal()"
        >
          Cancelar
        </button>
        <button
          type="button"
          class="rounded-lg bg-brand-500 px-6 py-2.5 text-sm font-medium text-white hover:bg-brand-600"
          (click)="submitVacationRequest()"
          [disabled]="isVacationSubmitting"
        >
          <span *ngIf="isVacationSubmitting" class="animate-spin mr-2">‚è≥</span>
          Enviar Solicitud
        </button>
      </div>
    </div>
  </app-modal>

  <!-- Modal de Gesti√≥n de Solicitudes (Solo Administrador) -->
  <app-modal
    [isOpen]="isVacationManagementOpen"
    (close)="closeVacationManagement()"
    className="max-w-[900px] p-6 lg:p-8"
  >
    <div class="flex flex-col px-2 max-h-[80vh] overflow-y-auto custom-scrollbar">
      <h5 class="mb-6 font-semibold text-gray-800 text-theme-xl dark:text-white/90 lg:text-2xl">
        Gesti√≥n de Solicitudes de Vacaciones
      </h5>

      @if (vacationRequests.length === 0) {
        <div class="text-center py-12">
          <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke-width="2"></rect>
            <line x1="16" y1="2" x2="16" y2="6" stroke-width="2"></line>
            <line x1="8" y1="2" x2="8" y2="6" stroke-width="2"></line>
            <line x1="3" y1="10" x2="21" y2="10" stroke-width="2"></line>
          </svg>
          <p class="mt-4 text-gray-500 dark:text-gray-400">No hay solicitudes de vacaciones</p>
        </div>
      } @else {
        <!-- Pesta√±as -->
        <div class="flex items-center gap-2 border-b border-gray-200 dark:border-gray-700 mb-4">
          <button type="button" (click)="setVacationTab('pending')"
            class="px-3 py-2 text-sm rounded-t-md hover:bg-gray-50 dark:hover:bg-gray-700"
            [class.bg-gray-100]="vacationTab === 'pending'"
            [class.dark:bg-gray-800]="vacationTab === 'pending'"
            [class.font-semibold]="vacationTab === 'pending'"
            [class.text-gray-900]="vacationTab === 'pending'"
            [class.dark:text-white]="vacationTab === 'pending'"
            [class.text-gray-600]="vacationTab !== 'pending'"
            [class.dark:text-gray-300]="vacationTab !== 'pending'">
            Pendientes ({{ pendingRequests.length }})
          </button>
          <button type="button" (click)="setVacationTab('approved')"
            class="px-3 py-2 text-sm rounded-t-md hover:bg-gray-50 dark:hover:bg-gray-700"
            [class.bg-gray-100]="vacationTab === 'approved'"
            [class.dark:bg-gray-800]="vacationTab === 'approved'"
            [class.font-semibold]="vacationTab === 'approved'"
            [class.text-gray-900]="vacationTab === 'approved'"
            [class.dark:text-white]="vacationTab === 'approved'"
            [class.text-gray-600]="vacationTab !== 'approved'"
            [class.dark:text-gray-300]="vacationTab !== 'approved'">
            Aprobadas ({{ approvedRequests.length }})
          </button>
          <button type="button" (click)="setVacationTab('rejected')"
            class="px-3 py-2 text-sm rounded-t-md hover:bg-gray-50 dark:hover:bg-gray-700"
            [class.bg-gray-100]="vacationTab === 'rejected'"
            [class.dark:bg-gray-800]="vacationTab === 'rejected'"
            [class.font-semibold]="vacationTab === 'rejected'"
            [class.text-gray-900]="vacationTab === 'rejected'"
            [class.dark:text-white]="vacationTab === 'rejected'"
            [class.text-gray-600]="vacationTab !== 'rejected'"
            [class.dark:text-gray-300]="vacationTab !== 'rejected'">
            Denegadas ({{ rejectedRequests.length }})
          </button>
          <button type="button" (click)="setVacationTab('completed')"
            class="px-3 py-2 text-sm rounded-t-md hover:bg-gray-50 dark:hover:bg-gray-700"
            [class.bg-gray-100]="vacationTab === 'completed'"
            [class.dark:bg-gray-800]="vacationTab === 'completed'"
            [class.font-semibold]="vacationTab === 'completed'"
            [class.text-gray-900]="vacationTab === 'completed'"
            [class.dark:text-white]="vacationTab === 'completed'"
            [class.text-gray-600]="vacationTab !== 'completed'"
            [class.dark:text-gray-300]="vacationTab !== 'completed'">
            Cumplidas ({{ completedRequests.length }})
          </button>
        </div>

        <!-- Contenido por pesta√±a -->
        <div class="space-y-4">
          @if (vacationTab === 'pending') {
            @for (request of pendingRequests; track request.id) {
              <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:shadow-md transition">
                <div class="flex items-start justify-between gap-4">
                  <div class="flex items-start gap-3 flex-1">
                    <div class="w-12 h-12 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-xl font-bold text-gray-600 dark:text-gray-300">{{ request.employeeName[0] }}</div>
                    <div class="flex-1">
                      <h6 class="font-semibold text-gray-900 dark:text-white">{{ request.employeeName }}</h6>
                      <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">
                        <span class="font-medium">{{ request.type === 'vacation' ? 'üèñÔ∏è Vacaciones' : 'üìÖ D√≠a Libre' }}</span>
                      </p>
                      <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">üìÖ {{ request.startDate }} - {{ request.endDate }}</p>
                      <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">üí¨ {{ request.reason }}</p>
                      <p class="text-xs text-gray-500 dark:text-gray-500 mt-2">Solicitado el: {{ request.requestDate }}</p>
                    </div>
                  </div>
                  <div class="flex flex-col items-end gap-2">
                    <span class="px-3 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400">Pendiente</span>
                    <div class="flex gap-2 mt-2">
                      <button type="button" (click)="approveVacationRequest(request.id)" class="px-3 py-1.5 text-xs font-medium rounded-lg bg-green-500 hover:bg-green-600 text-white transition" title="Aprobar">‚úì</button>
                      <button type="button" (click)="rejectVacationRequest(request.id)" class="px-3 py-1.5 text-xs font-medium rounded-lg bg-red-500 hover:bg-red-600 text-white transition" title="Rechazar">‚úï</button>
                      <button type="button" (click)="deleteVacationRequest(request.id)" class="px-3 py-1.5 text-xs font-medium rounded-lg bg-gray-500 hover:bg-gray-600 text-white transition" title="Eliminar">üóëÔ∏è</button>
                    </div>
                  </div>
                </div>
              </div>
            }
          } @else if (vacationTab === 'approved') {
            @for (request of approvedRequests; track request.id) {
              <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:shadow-md transition">
                <div class="flex items-start justify-between gap-4">
                  <div class="flex items-start gap-3 flex-1">
                    <div class="w-12 h-12 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-xl font-bold text-gray-600 dark:text-gray-300">{{ request.employeeName[0] }}</div>
                    <div class="flex-1">
                      <h6 class="font-semibold text-gray-900 dark:text-white">{{ request.employeeName }}</h6>
                      <p class="text-sm text-gray-600 dark:text-gray-400 mt-1"><span class="font-medium">{{ request.type === 'vacation' ? 'üèñÔ∏è Vacaciones' : 'üìÖ D√≠a Libre' }}</span></p>
                      <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">üìÖ {{ request.startDate }} - {{ request.endDate }}</p>
                      <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">üí¨ {{ request.reason }}</p>
                    </div>
                  </div>
                  <div class="flex flex-col items-end gap-2">
                    <span class="px-3 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400">Aprobado</span>
                    <div class="flex gap-2 mt-2">
                      <button type="button" (click)="deleteVacationRequest(request.id)" class="px-3 py-1.5 text-xs font-medium rounded-lg bg-gray-500 hover:bg-gray-600 text-white transition" title="Eliminar">üóëÔ∏è</button>
                    </div>
                  </div>
                </div>
              </div>
            }
          } @else if (vacationTab === 'rejected') {
            @for (request of rejectedRequests; track request.id) {
              <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:shadow-md transition">
                <div class="flex items-start justify-between gap-4">
                  <div class="flex items-start gap-3 flex-1">
                    <div class="w-12 h-12 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-xl font-bold text-gray-600 dark:text-gray-300">{{ request.employeeName[0] }}</div>
                    <div class="flex-1">
                      <h6 class="font-semibold text-gray-900 dark:text-white">{{ request.employeeName }}</h6>
                      <p class="text-sm text-gray-600 dark:text-gray-400 mt-1"><span class="font-medium">{{ request.type === 'vacation' ? 'üèñÔ∏è Vacaciones' : 'üìÖ D√≠a Libre' }}</span></p>
                      <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">üìÖ {{ request.startDate }} - {{ request.endDate }}</p>
                      <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">üí¨ {{ request.reason }}</p>
                    </div>
                  </div>
                  <div class="flex flex-col items-end gap-2">
                    <span class="px-3 py-1 text-xs font-medium rounded-full bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400">Rechazado</span>
                    <div class="flex gap-2 mt-2">
                      <button type="button" (click)="deleteVacationRequest(request.id)" class="px-3 py-1.5 text-xs font-medium rounded-lg bg-gray-500 hover:bg-gray-600 text-white transition" title="Eliminar">üóëÔ∏è</button>
                    </div>
                  </div>
                </div>
              </div>
            }
          } @else {
            @for (request of completedRequests; track request.id) {
              <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:shadow-md transition">
                <div class="flex items-start justify-between gap-4">
                  <div class="flex items-start gap-3 flex-1">
                    <div class="w-12 h-12 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-xl font-bold text-gray-600 dark:text-gray-300">{{ request.employeeName[0] }}</div>
                    <div class="flex-1">
                      <h6 class="font-semibold text-gray-900 dark:text-white">{{ request.employeeName }}</h6>
                      <p class="text-sm text-gray-600 dark:text-gray-400 mt-1"><span class="font-medium">{{ request.type === 'vacation' ? 'üèñÔ∏è Vacaciones' : 'üìÖ D√≠a Libre' }}</span></p>
                      <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">üìÖ {{ request.startDate }} - {{ request.endDate }}</p>
                      <p class="text-xs text-gray-500 dark:text-gray-500 mt-2">Finalizadas</p>
                    </div>
                  </div>
                  <div class="flex flex-col items-end gap-2">
                    <span class="px-3 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-800 dark:bg-gray-700/50 dark:text-gray-200">Cumplida</span>
                    <div class="flex gap-2 mt-2">
                      <button type="button" (click)="deleteVacationRequest(request.id)" class="px-3 py-1.5 text-xs font-medium rounded-lg bg-gray-500 hover:bg-gray-600 text-white transition" title="Eliminar">üóëÔ∏è</button>
                    </div>
                  </div>
                </div>
              </div>
            }
          }
        </div>
      }

      <div class="flex justify-end pt-6 mt-6 border-t border-gray-200 dark:border-gray-700">
        <button
          type="button"
          class="rounded-lg border border-gray-300 bg-white px-6 py-2.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300"
          (click)="closeVacationManagement()"
        >
          Cerrar
        </button>
      </div>
    </div>
  </app-modal>

  <!-- Modal de confirmaci√≥n de eliminaci√≥n de tarea -->
  @if (deleteConfirmation.isOpen) {
    <div class="fixed inset-0 z-[100] flex items-center justify-center bg-black/40 px-4" (click)="closeDeleteConfirmation()">
      <div
        class="w-full max-w-md rounded-2xl bg-white p-6 shadow-2xl dark:bg-gray-900"
        (click)="$event.stopPropagation()"
      >
        <div class="flex items-start justify-between gap-4">
          <div class="flex items-start gap-4">
            <div class="flex-shrink-0">
              <svg class="h-6 w-6 text-error-600 dark:text-error-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
              </svg>
            </div>
            <div>
              <h4 class="text-lg font-semibold text-gray-900 dark:text-white">Eliminar tarea</h4>
              <p class="mt-2 text-sm text-gray-600 dark:text-gray-400">
                ¬øEst√°s seguro de que deseas eliminar <strong>{{ deleteConfirmation.taskTitle }}</strong>?
              </p>
              <div class="mt-3 rounded-lg bg-red-50 border border-red-200 p-3 dark:bg-red-900/20 dark:border-red-800/50">
                <p class="text-xs text-red-800 dark:text-red-300 font-medium">
                  ‚ö†Ô∏è Esta acci√≥n no se puede deshacer
                </p>
              </div>
            </div>
          </div>
          <button
            type="button"
            (click)="closeDeleteConfirmation()"
            class="text-gray-400 transition hover:text-gray-600 dark:hover:text-gray-200"
            aria-label="Cerrar"
          >
            ‚úï
          </button>
        </div>

        <div class="mt-6 flex items-center justify-end gap-3">
          <button
            type="button"
            (click)="closeDeleteConfirmation()"
            class="inline-flex items-center justify-center gap-2 rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-white/[0.06]"
          >
            Cancelar
          </button>
          <button
            type="button"
            (click)="confirmDeleteTask()"
            class="inline-flex items-center justify-center gap-2 rounded-lg bg-error-600 px-4 py-2 text-sm font-medium text-white shadow-theme-sm transition hover:bg-error-700 focus:outline-none focus:ring-2 focus:ring-error-200 dark:bg-error-500/80 dark:hover:bg-error-600"
          >
            Eliminar tarea
          </button>
        </div>
      </div>
    </div>
  }

  <!-- Modal de Decisi√≥n de Vacaciones (Aprobar/Rechazar con comentario) -->
  <app-modal
    [isOpen]="vacationDecisionModal.isOpen"
    (close)="closeVacationDecisionModal()"
    className="max-w-[500px] p-6"
  >
    <div class="flex flex-col">
      <div class="mb-6">
        <h5 class="font-semibold text-gray-800 text-lg dark:text-white/90">
          {{ vacationDecisionModal.action === 'approve' ? 'Aprobar' : 'Rechazar' }} Solicitud
        </h5>
        <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">
          {{ vacationDecisionModal.action === 'approve'
            ? '¬øDeseas enviar un correo de confirmaci√≥n al empleado?'
            : '¬øDeseas enviar un correo con el motivo del rechazo?' }}
        </p>
      </div>

      <div class="space-y-4">
        <!-- Opci√≥n de enviar correo -->
        <div class="flex items-center gap-3">
          <input
            type="checkbox"
            id="sendEmailCheckbox"
            [(ngModel)]="vacationDecisionModal.sendEmail"
            class="w-4 h-4 rounded border-gray-300 text-brand-600 focus:ring-brand-500 cursor-pointer dark:border-gray-600 dark:bg-gray-800"
          />
          <label for="sendEmailCheckbox" class="text-sm font-medium text-gray-700 dark:text-gray-300 cursor-pointer">
            Enviar correo de notificaci√≥n
          </label>
        </div>

        <!-- Campo de comentario (mostrar si est√° habilitado enviar correo) -->
        @if (vacationDecisionModal.sendEmail) {
          <div class="mt-4 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700">
            <label for="emailComment" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
              Comentario para el correo (opcional)
            </label>
            <textarea
              id="emailComment"
              [(ngModel)]="vacationDecisionModal.emailComment"
              placeholder="Ej: Tu solicitud ha sido {{ vacationDecisionModal.action === 'approve' ? 'aprobada' : 'rechazada' }}. Cualquier duda, cont√°ctame."
              class="w-full h-28 p-3 rounded-lg border border-gray-300 bg-white text-sm text-gray-800 shadow-theme-xs focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-gray-600 dark:bg-gray-900 dark:text-white/90 resize-none"
            ></textarea>
            <p class="mt-2 text-xs text-gray-500 dark:text-gray-400">
              Este comentario se incluir√° en el correo de notificaci√≥n.
            </p>
          </div>
        }
      </div>

      <!-- Botones -->
      <div class="mt-6 flex items-center justify-end gap-3">
        <button
          type="button"
          (click)="closeVacationDecisionModal()"
          [disabled]="vacationDecisionModal.isLoading"
          class="inline-flex items-center justify-center gap-2 rounded-lg border border-gray-300 px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:border-gray-700 dark:text-gray-300 dark:hover:bg-white/[0.06]"
          [class.opacity-50]="vacationDecisionModal.isLoading"
          [class.cursor-not-allowed]="vacationDecisionModal.isLoading"
        >
          Cancelar
        </button>
        <button
          type="button"
          (click)="confirmVacationDecision()"
          [disabled]="vacationDecisionModal.isLoading"
          [ngClass]="vacationDecisionModal.action === 'approve'
            ? 'bg-success-600 hover:bg-success-700 focus:ring-success-200 dark:bg-success-500/80 dark:hover:bg-success-600'
            : 'bg-error-600 hover:bg-error-700 focus:ring-error-200 dark:bg-error-500/80 dark:hover:bg-error-600'"
          [class.opacity-50]="vacationDecisionModal.isLoading"
          [class.cursor-not-allowed]="vacationDecisionModal.isLoading"
          class="inline-flex items-center justify-center gap-2 rounded-lg px-4 py-2 text-sm font-medium text-white shadow-theme-sm transition focus:outline-none focus:ring-2"
        >
          @if (vacationDecisionModal.isLoading) {
            <svg class="w-4 h-4 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            {{ vacationDecisionModal.action === 'approve' ? 'Aprobando...' : 'Rechazando...' }}
          } @else {
            {{ vacationDecisionModal.action === 'approve' ? '‚úì Aprobar' : '‚úï Rechazar' }}
          }
        </button>
      </div>
    </div>
  </app-modal>
</div>
